<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/icon" href="./img/favicon.ico">
    <title>RecuperarContraseña</title>
    
    <link rel="stylesheet" href="css/estilos.css">
    <link rel="stylesheet" href="css/password.css">
    <link rel="shortcut icon" href="/img/favicon.png" type="image/x-icon" />


</head>
<body>
 <section>
<div class="card">
  <div class="BG">
    <svg
      viewBox="0 0 512 512"
      class="ionicon"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        d="M256 176a80 80 0 1080 80 80.24 80.24 0 00-80-80zm172.72 80a165.53 165.53 0 01-1.64 22.34l48.69 38.12a11.59 11.59 0 012.63 14.78l-46.06 79.52a11.64 11.64 0 01-14.14 4.93l-57.25-23a176.56 176.56 0 01-38.82 22.67l-8.56 60.78a11.93 11.93 0 01-11.51 9.86h-92.12a12 12 0 01-11.51-9.53l-8.56-60.78A169.3 169.3 0 01151.05 393L93.8 416a11.64 11.64 0 01-14.14-4.92L33.6 331.57a11.59 11.59 0 012.63-14.78l48.69-38.12A174.58 174.58 0 0183.28 256a165.53 165.53 0 011.64-22.34l-48.69-38.12a11.59 11.59 0 01-2.63-14.78l46.06-79.52a11.64 11.64 0 0114.14-4.93l57.25 23a176.56 176.56 0 0138.82-22.67l8.56-60.78A11.93 11.93 0 01209.94 26h92.12a12 12 0 0111.51 9.53l8.56 60.78A169.3 169.3 0 01361 119l57.2-23a11.64 11.64 0 0114.14 4.92l46.06 79.52a11.59 11.59 0 01-2.63 14.78l-48.69 38.12a174.58 174.58 0 011.64 22.66z"
      ></path>
    </svg>
  </div>
  <div class="content">
    <p class="heading">¡Restablecer!</p>
    <br>
    <p class="sub-heading">Cambiar tu contraseña</p>
    <br>
    <p class="sub-sub-heading">Escribe tu correo electrónico y la nueva contraseña</p>
    
    <input id="email_recover" class="input-field" placeholder="Correo Electrónico" type="email" required />
    <input id="pass_recover" class="input-field" placeholder="Nueva Contraseña" type="password" required />

    <button class="card-btn" id="btn_recover">Cambiar Contraseña</button>
   
    <a class="login" href="login.html">Login</a>
      <a class="login" href="singin.html">singin</a>

  </div>
</div>
</section>

<script>

    document.getElementById('btn_recover').addEventListener('click', async () => {
        const email = document.getElementById('email_recover').value;
        const password = document.getElementById('pass_recover').value;

        if (!email || !password) {
            alert("Por favor, completa ambos campos.");
            return;
        }

        const url = '/users/recoverPassword';
        try {
            const response = await fetch(url, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    Email: email,
                    Pass: password
                })
            });

            const data = await response.json();
            
            if (response.ok) { // Status 200
                alert(data.message); 
                window.location.href = 'login.html'; // Redirigir al login si es exitoso
            } else {
                alert(`Error: ${data.message}`);
            }
        } catch (error) {
            console.error("Error de red o servidor:", error);
            alert("Error al intentar cambiar la contraseña.");
        }
    });
</script>

</body>
</html>